import{makeCurtains as e}from"./curtain.js";const t=Object.fromEntries(new URLSearchParams(window.location.search));console.log(t);const n=function(e,t,n,a,o){return n-a>0?((n=(n-a)/(o-a))>1&&(n=1),n<0&&(n=0),e*(1-n)+t*n):e};var a=document;window.encode=e=>encodeURIComponent(btoa(unescape(encodeURIComponent(e))));window.decode=e=>atob(e);const o=e=>btoa(unescape(encodeURIComponent(e))).replace(/^=+|=+$|[\+/]/g,"").substr(0,5);window.hash=o;window.getBgImageDim=e=>{var t=e.style.backgroundImage.replace(/url\((['"])?(.*?)\1\)/gi,"$2").split(",")[0],n=new Image;return n.src=t,{width:n.width,height:n.height}};var i=console.log,r=e=>console.log("%c"+e,"padding:0.3em 0.7em;background: #ddd; color: #000;font-weight:900;");function s(e,t){if(!e)throw t||"Assertion failed"}a.getElementById("debug").style.display="";const l=parseInt(t.skip);l&&(r("Skipping "+l+" stages"),Array.from(document.getElementById("stages").children).splice(1,l).forEach(e=>{i(e),e.remove()}));function c(){a.querySelectorAll("[scale-to-fit-parent-width]").forEach(e=>{var t=e.parentElement.clientWidth/e.clientWidth;t<=1&&(t=1),e.scale=t,e.style.transform="translateX("+(e.translateX||"0px")+") scale("+(e.scale||1)+")"}),a.querySelectorAll("[scale-to-fit-parent-height]").forEach(e=>{var t=e.parentElement.clientHeight/e.clientHeight;t<=1&&(t=1),e.scale=t,e.style.transform="translateX("+(e.translateX||"0px")+") scale("+(e.scale||1)+")"});let e=window.innerHeight,t=window.innerWidth,n=e,o=t,i=1;o>480?(document.body.style.width="480px",document.body.style.marginLeft=parseInt((o-480)/2)+"px",o=480):(document.body.style.width="",document.body.style.marginLeft=""),n>640?(document.body.style.height="640px",document.body.style.marginTop=parseInt((n-640)/2)+"px",i=n/640,n=640):(document.body.style.height="",document.body.style.marginTop="",document.body.style.transform="",i=1);t/e<.75&&(console.log(),o=t/i,document.body.style.width=o+"px",document.body.style.marginLeft=parseInt((t-o)/2)+"px"),document.body.style.transform=1==i?"":"scale("+i+")";let r=.01*n,s=.01*o;document.documentElement.style.setProperty("--vh",`${r}px`),document.documentElement.style.setProperty("--vw",`${s}px`),document.documentElement.style.setProperty("--scale",`${i}`),document.documentElement.style.setProperty("--window-height",`${n}px`),document.documentElement.style.setProperty("--window-width",`${o}px`),document.querySelectorAll("[full-width-abs]").forEach(e=>{"svg"==e.tagName?e.setAttribute("width",o):e.style.width=o+"px"}),document.querySelectorAll("[full-height-abs]").forEach(e=>{"svg"==e.tagName?e.setAttribute("height",n):e.style.height=n+"px"}),window.dispatchEvent(new Event("curtain-resize"))}var d=function(e){c()};window.attachEvent?window.attachEvent("onresize",d):window.addEventListener&&window.addEventListener("resize",d,!0);var m=(navigator.language||navigator.userLanguage).indexOf("zh")>-1?"zh":"en";a.getElementById("app").classList.remove("hidden"),FastClick.attach(a.body);var u=function(e){a.body.setAttribute("lang",e),document.querySelectorAll("[en],[zh]").forEach(t=>{var n=t.attributes.en,a=t.attributes.zh;n&&(n=n.value),a&&(a=a.value),("en"==e&&n||"zh"==e&&!a)&&(t.textContent=n),("zh"==e&&a||"en"==e&&!n)&&(t.textContent=a)})};a.addEventListener("DOMContentLoaded",(function(){u(m),c()})),document.querySelectorAll("#lang-switcher > span").forEach(e=>{e.classList.remove("display-none");let t=function(e){document.querySelectorAll("#lang-switcher > span").forEach(e=>e.classList.remove("display-none")),this.classList.add("display-none"),u(this.textContent),m=this.textContent};e.addEventListener("click",t),e.addEventListener("touchstart",t)}),document.querySelector("#lang-switcher > span").classList.add("display-none"),"zh"==m&&document.querySelector("#lang-switcher > span:not([class])").click(),window.mobilecheck=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t};var h,p="!內在滿足;;Intrinsic satisfaction\n精神層面上的​滿足;;Mentally Satisfied\n與神有親密連繫;;Closely connected with God\n持續的認識自我;;Continuous ​self-exploration\n擁有自我內心的​空間;;Have an inner space \n安全感;;Sense of secure\n內心的平靜;;Have an inner peace \n新鮮感;;Sense of freshness\n感到自在;;Feel comfortable \n\n!人際關係;;Inter-personal relationship\n擁有自在舒適的​人際關係;;Got a comfortable ​inter-personal ​relationship\n美滿婚姻;;Happy marriage\n有交心知己;;Have Best Friend Forever\n有親近的好朋友;;Have good friends\n親密的家庭;;A close family \n孝順父母;;Filial Piety\n和一群人一起打拼;;Work hard with others\n讚賞及鼓勵別人;;Appreciate and ​encourage others\n有意義的愛情;;A meaningful ​love-relationship  \n幫助別人;;Help others\n\n!物質享受;;Materialistic\n有車 / 有樓;;Own a Car/House\n賺大錢;;Be wealthy\n時尚的打扮;;Fashionable dress up\n錢夠用 ​(沒有經濟上的​擔憂);;Sufficient amount of money ​(without financial burden)\n追上科技潮流;;Catch up on technology   \n建立社會地位;;Have social status\n環遊世界;;Travel around the world\n食盡美食;;Enjoy food\n\n!生活模式;;Life style\n簡簡單單的生活;;Simple life\n參加藝文青活動;;Participate art and ​cultural activities \n親親大自然;;Enjoy nature\n人生充滿樂趣;;Interesting life\n多姿多彩的生活;;Fruitful life\n參與宗教、政治、​社團活動;;Participate in religions, ​politics and/or ​different societies\n什麼事都不做;;Do nothing\n規律的生活;;Regular daily life\n安穩的工作;;Stable job\n享受獨處的時光;;Enjoy being alone \n做自己喜歡的事;;Do what you like\n持續地學習;;Continuous learning \n休息與放鬆;;Rest and relaxing\n運動;;Exercises\n擁有健康;;Be healthy\n長久的生命;;A long life\n為夢想奮鬥;;Work hard on your dream\n冒險與刺激;;Adventure and excitement\n成為眾人焦點;;Be the focus of everyone \n做善事;;Do good deed\n擁有自由;;Have freedom\n做自己;;Be yourself \n生小朋友;;Have kids\n有意義的工作;;A meaningful job\n\n!自我形象;;Self-image \n誠實正直;;Integrity\n心地善良;;Kind-hearted \n公平、公正;;Be fair and impartial \n擁有純潔及​真摯的心;;Be pure and true\n勇於改變;;Dare to Change \n有自信;;Confident\n有正義感;;Have a sense of justice\n義氣仔女;;Be loyal to friends \n腳踏實地;;Be practical and ​down-to-earth\n勇於接受挑戰;;Dare to accept challenge\n努力向上;;Hard-working\n用心/盡力做事;;Do your best on everything\n有美感;;Be aesthetic \n開放性的思維;;Open minded\n寛容;;Tolerance \n廣闊的視野;;Have wide horizon\n獨立自主;;Independence\n有影響力;;Be an influential person\n事業有成;;Successful in your career\n能夠發揮所長;;Able to use your talent\n擁有一己之長;;Have your own talent",g=["zh","en"],y=g.length,f=[],w={},v=[],b=[];p.split("\n").filter(e=>e.trim()).forEach(e=>{var t,n;e.startsWith("!")?(b.length>0&&(w[h]=b),s((t=e.substr(1).split(";;").map(e=>e.trim())).length==y,"invalid data: "+t),n={id:f.length,name:{}},g.forEach((e,a)=>{n.name[e]=t[a]}),n.code=o(n.name[g[0]]),h=n.id,f.push(n)):(s((t=e.split(";;").map(e=>e.trim())).length==y,"invalid data: "+t),b.push(t),n={id:v.length,name:{},type:h,picked:!1,droped:!1},g.forEach((e,a)=>{n.name[e]=t[a]}),v.push(n))}),b.length>0&&(w[f[f.length-1].id]=b);var E=v.slice(0);(e=>{var t,n,a;for(a=e.length-1;a>0;a--)t=Math.floor(Math.random()*(a+1)),n=e[a],e[a]=e[t],e[t]=n})(E);var k=((e,t)=>{for(var n=[],a=0,o=e.length;a<o;)n.push(e.slice(a,a+=t));return n})(E,6);console.log(f),window.CARDS=v,window.CARDS_TYPES=f,window.CARDS_ITEMS=w,window.CARDS_SHUFFLED=E,window.CARDS_CHUNKS=k;var x=["assets/img/bg01.png","assets/img/cover.png"],A=0,L=x.length,S=a.getElementById("load-percent"),C=a.getElementById("loading-wrapper"),I=function(){S.textContent=L?parseInt(++A/L*100):100,A==L&&(r("All assets loaded."),P(),c())};x.forEach(e=>loadjs(e,I)),0==L&&document.addEventListener("DOMContentLoaded",I);var B={x:0,y:0};document.addEventListener("mousemove",(function(e){!function(e){B.x=e.pageX,B.y=e.pageY}(e)}));var z,q=a.getElementById("volume"),H=q.querySelector(".switchContainer"),j=H.classList.contains("switchOn"),D=e=>{anime({targets:z,volume:e,duration:500,easing:"easeOutQuad"})},O=()=>{z||((z=new Audio("https://www.bensound.com/bensound-music/bensound-beyondtheline.mp3")).volume=.5),z.play()},R=()=>{j?(j=!1,D(0),H.classList.remove("switchOn"),H.classList.add("switchOff")):(j=!0,D(.5),H.classList.add("switchOn"),H.classList.remove("switchOff"),O())};q.onclick=R,q.ontouchstart=R;var P=function(){var e,t;e=C,t=e=>{r("Load wrapper removed."),l||Q[0].show()},anime({targets:e,opacity:0,duration:750,easing:"easeOutQuad",delay:0,complete:function(n){e.remove(),t()}}),l&&(Q[0].show(),Q[0].endCurtain(!0))};const M=e=>[function(){var t=e.obj.querySelector(".curtain-page");t&&t.curtain.show()},e.opened?0:500],X=e=>new Promise((function(t,n){setTimeout(t,e)})),F=function(e){if(0==e.length)return;var t=0,n=e[0];const a=e=>setTimeout(()=>o(e),n.duration||n[1]||0),o=function(o){var i,r=n.func||n[0]||n;if("function"!=typeof r)throw"timeline contains non-callable elements";i=r(o),(t+=1)<e.length&&(n=e[t],i&&i.then?i.then(e=>a(e)):a())};a()},N=e=>(i("fade",e),anime.timeline({targets:e,delay:anime.stagger(500),easing:"linear"}).add({opacity:1}).finished);window.intro_next=function(e){e.obj;F([[function(){document.getElementById("float-top-right").classList.remove("hidden")},500],[function(){O()},500],()=>X(1e3),()=>N("#intro-tran-text p"),M(e)])};const U=Array.from(document.querySelectorAll("#intro [drag]")).map(e=>[e,parseInt(e.getAttribute("drag"))]);window.coverUpdate=(e,t)=>{U.forEach(e=>{var n=e[0],a=e[1];n.translateX=-a*t+"px",n.style.transform="translateX("+n.translateX+") scale("+(n.scale||1)+")"})};var T=0;a.getElementById("app").addEventListener("click",(function(e){for(var t=e.target;t&&"CARD"!=t.tagName;)t=t.parentElement;t&&(t.classList.toggle("active"),console.log(t))}));const _=(e,t,n)=>new Promise((function(a,o){Array.from(e.children).filter(e=>"BACKGROUND"==e.tagName)[0].querySelector("bg img").style.transform="translateX(calc((-100% + var(--window-width, 100vw)) / "+n+" * "+t+"))",a()})),W=e=>{var t=Math.random()>.5,a=(t?0:.025)+.025*Math.random(),o=(t?.85:.8)+.05*Math.random(),i=(o-a)/6-.12,r=0,s=parseInt(document.documentElement.style.getPropertyValue("--window-width")),l=n(.075,.1,s,340,480),c=n(.01,.15,s,340,480),d=n(.01,.15,s,340,480),m=e=>{var t=Math.random()*l;return r=t,t=t*(1-d)+d,e.style.left=100*t+"%",e.style.right="unset",t},u=e=>{var t,n,a=(t=l)>(n=1-r-l)?n:t,o=Math.random()*a;o=o*(1-c)+c,e.style.right=100*o+"%",e.style.left="unset"};e.forEach((e,n)=>{var a=Math.random()*i+.06+n*(i+.12);e.style.top=100*a+"%",(n%2==(t?1:0)?m:u)(e),e.style.pointerEvents="all"})},$=e=>{var t=e=>{e.style.opacity="0",e.style.pointerEvents="none"};e.forEach?e.forEach(t):t(e)},G=(e,t)=>{for(var n=k[t],a=0;a<e.length;a++){var o=e[[a]];if(a>=n.length)o.classList.remove("active");else{var i=n[a];o.classList.add("active"),o.setAttribute("id",i.id);var r=o.querySelector("p");Object.keys(i.name).forEach(e=>r.setAttribute(e,i.name[e].replace(/ *\u200b/g,"\n"))),u(m)}}},K=e=>{var t=(e=>Array.from(e.children).filter(e=>"ARROWS"==e.tagName)[0])(e);return t.style.opacity=1,t.style.transform="translateX(0)",new Promise((function(e,n){var a=n=>{t.removeEventListener("click",a),t.removeEventListener("touchend",a),t.style.opacity=0,e()};t.addEventListener("click",a),t.addEventListener("touchend",a)}))};window.stage_next=function(e){var t=e.obj,n=Array.from(t.children).filter(e=>"BACKGROUND"==e.tagName)[0].querySelectorAll("card"),a=Array.from(t.children).filter(e=>e.classList.contains("thin-body"))[0],o=a.querySelectorAll("p");F([()=>X(1500),()=>N(o),()=>X(500),()=>K(t),()=>$(a),()=>X(500),()=>_(t,1,4),()=>X(2e3),()=>W(n),()=>G(n,T++),()=>N(n),()=>X(1500),()=>K(t),()=>$(n),()=>X(500),()=>_(t,2,4),()=>X(2e3),()=>W(n),()=>G(n,T++),()=>N(n),()=>X(1500),()=>K(t),()=>$(n),()=>X(500),()=>_(t,3,4),()=>X(2e3),()=>W(n),()=>G(n,T++),()=>N(n),()=>X(1500),()=>K(t),()=>$(n),()=>X(500),()=>_(t,4,4),()=>X(2e3),()=>W(n),()=>G(n,T++),()=>N(n),()=>X(1500),()=>K(t),M(e)])};var Q=e(a.getElementById("stages"));